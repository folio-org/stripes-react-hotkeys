/**
 * Copyright (c) 2015 Chris Pearce <hello@chrispearce.me>
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var React=_interopDefault(require("react")),ReactDOM=_interopDefault(require("react-dom")),PropTypes=_interopDefault(require("prop-types")),isEqual=_interopDefault(require("lodash/isEqual")),isBool=_interopDefault(require("lodash/isBoolean")),isArray=_interopDefault(require("lodash/isArray")),omit=_interopDefault(require("lodash/omit"));function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,o=arguments[t];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};for(var n,o={},r=Object.keys(e),i=0;i<r.length;i++)n=r[i],0<=t.indexOf(n)||(o[n]=e[n]);return o}function _objectWithoutProperties(e,t){if(null==e)return{};var n,o=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols)for(var r=Object.getOwnPropertySymbols(e),i=0;i<r.length;i++)n=r[i],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n]);return o}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _createSuper(n){var o=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(n);return _possibleConstructorReturn(this,o?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function addFocusListener(e,t){var n,o="onfocusin"in document?!(n="focusin"):(n="focus",!0);e.addEventListener(n,t,o);return{remove:function(){return e.removeEventListener(n,t,o)}}}function addBlurListener(e,t){var n,o="onfocusout"in document?!(n="focusout"):(n="blur",!0);e.addEventListener(n,t,o);return{remove:function(){return e.removeEventListener(n,t,o)}}}var _excluded=["component","children","noWrapper","element"],FocusTrap=function(){_inherits(n,React.Component);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),(e=t.call(this,e)).focusListener,e.blurListener,e.willWrap=!e.props.noWrapper,e.setupNativeListeners=e.setupNativeListeners.bind(_assertThisInitialized(e)),e.removeNativeListeners=e.removeNativeListeners.bind(_assertThisInitialized(e)),e}return _createClass(n,[{key:"componentDidMount",value:function(){!this.willWrap&&this.props.element&&this.setupNativeListeners()}},{key:"componentDidUpdate",value:function(e){!e.element&&this.props.element&&this.setupNativeListeners()}},{key:"componentWillUnmount",value:function(){this.removeNativeListeners()}},{key:"setupNativeListeners",value:function(){var e,t,n;this.focusListener||(e=(n=this.props).onFocus,t=n.onBlur,(n=n.element)&&!this.focusListener?(n.getAttribute("tabindex")||n.setAttribute("tabindex","-1"),this.focusListener=addFocusListener(n,e),this.blurListener=addBlurListener(n,t)):this.willWrap=!0)}},{key:"removeNativeListeners",value:function(){this.focusListener&&(this.focusListener.remove(),this.focusListener=null),this.blurListener&&(this.blurListener.remove(),this.blurListener=null)}},{key:"render",value:function(){var e=this.props,t=e.component,n=e.children,e=(e.noWrapper,e.element,_objectWithoutProperties(e,_excluded));return this.willWrap?React.createElement(t,_extends({tabIndex:"-1"},e),n):n}}]),n}();function contains(e,t){if(e&&t){if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return e===t||16===e.compareDocumentPosition(t)}return!1}_defineProperty(FocusTrap,"propTypes",{onFocus:PropTypes.func,onBlur:PropTypes.func,component:PropTypes.any,noWrapper:PropTypes.bool,children:PropTypes.node}),_defineProperty(FocusTrap,"defaultProps",{component:"div"});var HotKeysContext=React.createContext({hotKeyParent:null,hotKeyMap:{}}),withHotKeys=function(n){function e(t){return React.createElement(HotKeysContext.Consumer,null,function(e){return React.createElement(n,_extends({HKcontext:e},t))})}return e.displayName="HotKeys-".concat(n.displayName||n.name||"Component"),e},HotKeysProvider=HotKeysContext.Provider,commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function KeyCombo(e){this.sourceStr=e,this.subCombos=KeyCombo.parseComboStr(e),this.keyNames=this.subCombos.reduce(function(e,t){return e.concat(t)},[])}KeyCombo.sequenceDeliminator=">>",KeyCombo.comboDeliminator=">",KeyCombo.keyDeliminator="+",KeyCombo.parseComboStr=function(e){for(var t=KeyCombo._splitStr(e,KeyCombo.comboDeliminator),n=[],o=0;o<t.length;o+=1)n.push(KeyCombo._splitStr(t[o],KeyCombo.keyDeliminator));return n},KeyCombo.prototype.check=function(e){for(var t=0,n=0;n<this.subCombos.length;n+=1)if(-1===(t=this._checkSubCombo(this.subCombos[n],t,e)))return!1;return!0},KeyCombo.prototype.isEqual=function(e){if(!e||"string"!=typeof e&&"object"!=typeof e)return!1;if("string"==typeof e&&(e=new KeyCombo(e)),this.subCombos.length!==e.subCombos.length)return!1;for(var t=0;t<this.subCombos.length;t+=1)if(this.subCombos[t].length!==e.subCombos[t].length)return!1;for(t=0;t<this.subCombos.length;t+=1){for(var n=this.subCombos[t],o=e.subCombos[t].slice(0),r=0;r<n.length;r+=1){var i=n[r],i=o.indexOf(i);-1<i&&o.splice(i,1)}if(0!==o.length)return!1}return!0},KeyCombo._splitStr=function(e,t){for(var n=e,o=t,r="",i=[],s=0;s<n.length;s+=1)0<s&&n[s]===o&&"\\"!==n[s-1]&&(i.push(r.trim()),r="",s+=1),r+=n[s];return r&&i.push(r.trim()),i},KeyCombo.prototype._checkSubCombo=function(e,t,n){e=e.slice(0),n=n.slice(t);for(var o=t,r=0;r<e.length;r+=1){var i,s=e[r];"\\"===s[0]&&((i=s.slice(1))!==KeyCombo.comboDeliminator&&i!==KeyCombo.keyDeliminator||(s=i));s=n.indexOf(s);if(-1<s&&(e.splice(r,1),--r,o<s&&(o=s),0===e.length))return o}return-1};var keyCombo=KeyCombo;function Locale(e){this.localeName=e,this.pressedKeys=[],this._appliedMacros=[],this._keyMap={},this._killKeyCodes=[],this._macros=[]}Locale.prototype.bindKeyCode=function(e,t){this._keyMap[e]=t="string"==typeof t?[t]:t},Locale.prototype.bindMacro=function(e,t){var n=null;"function"==typeof(t="string"==typeof t?[t]:t)&&(n=t,t=null);n={keyCombo:new keyCombo(e),keyNames:t,handler:n};this._macros.push(n)},Locale.prototype.getKeyCodes=function(e){var t,n=[];for(t in this._keyMap)-1<this._keyMap[t].indexOf(e)&&n.push(0|t);return n},Locale.prototype.getKeyNames=function(e){return this._keyMap[e]||[]},Locale.prototype.setKillKey=function(e){if("string"!=typeof e)this._killKeyCodes.push(e);else for(var t=this.getKeyCodes(e),n=0;n<t.length;n+=1)this.setKillKey(t[n])},Locale.prototype.pressKey=function(e){if("string"!=typeof e){for(var t=this.getKeyNames(e),n=0;n<t.length;n+=1)-1===this.pressedKeys.indexOf(t[n])&&this.pressedKeys.push(t[n]);this._applyMacros()}else for(var o=this.getKeyCodes(e),n=0;n<o.length;n+=1)this.pressKey(o[n])},Locale.prototype.releaseKey=function(e){if("string"==typeof e)for(var t=this.getKeyCodes(e),n=0;n<t.length;n+=1)this.releaseKey(t[n]);else{var o=this.getKeyNames(e);if(-1<this._killKeyCodes.indexOf(e))this.pressedKeys.length=0;else for(n=0;n<o.length;n+=1){var r=this.pressedKeys.indexOf(o[n]);-1<r&&this.pressedKeys.splice(r,1)}this._clearMacros()}},Locale.prototype._applyMacros=function(){for(var e=this._macros.slice(0),t=0;t<e.length;t+=1){var n=e[t];if(n.keyCombo.check(this.pressedKeys)){n.handler&&(n.keyNames=n.handler(this.pressedKeys));for(var o=0;o<n.keyNames.length;o+=1)-1===this.pressedKeys.indexOf(n.keyNames[o])&&this.pressedKeys.push(n.keyNames[o]);this._appliedMacros.push(n)}}},Locale.prototype._clearMacros=function(){for(var e=0;e<this._appliedMacros.length;e+=1){var t=this._appliedMacros[e];if(!t.keyCombo.check(this.pressedKeys)){for(var n=0;n<t.keyNames.length;n+=1){var o=this.pressedKeys.indexOf(t.keyNames[n]);-1<o&&this.pressedKeys.splice(o,1)}t.handler&&(t.keyNames=null),this._appliedMacros.splice(e,1),--e}}};var locale=Locale;function Keyboard(e,t,n,o){this._locale=null,this._currentContext=null,this._contexts={},this._listeners=[],this._appliedListeners=[],this._locales={},this._targetElement=null,this._targetWindow=null,this._targetPlatform="",this._targetUserAgent="",this._isModernBrowser=!1,this._targetKeyDownBinding=null,this._targetKeyUpBinding=null,this._targetResetBinding=null,this._paused=!1,this._callerHandler=null,this.setContext("global"),this.watch(e,t,n,o)}Keyboard.prototype.setLocale=function(e,t){var n=null;"string"==typeof e?t?t(n=new locale(e),this._targetPlatform,this._targetUserAgent):n=this._locales[e]||null:e=(n=e)._localeName,this._locale=n,(this._locales[e]=n)&&(this._locale.pressedKeys=n.pressedKeys)},Keyboard.prototype.getLocale=function(e){return e=e||this._locale.localeName,this._locales[e]||null},Keyboard.prototype.bind=function(e,t,n,o){if(null!==e&&"function"!=typeof e||(o=n,n=t,t=e,e=null),e&&"object"==typeof e&&"number"==typeof e.length)for(var r=0;r<e.length;r+=1)this.bind(e[r],t,n);else this._listeners.push({keyCombo:e?new keyCombo(e):null,pressHandler:t||null,releaseHandler:n||null,preventRepeat:o||!1,preventRepeatByDefault:o||!1})},Keyboard.prototype.addListener=Keyboard.prototype.bind,Keyboard.prototype.on=Keyboard.prototype.bind,Keyboard.prototype.unbind=function(e,t,n){if(null!==e&&"function"!=typeof e||(n=t,t=e,e=null),e&&"object"==typeof e&&"number"==typeof e.length)for(var o=0;o<e.length;o+=1)this.unbind(e[o],t,n);else for(o=0;o<this._listeners.length;o+=1){var r=this._listeners[o],i=!e&&!r.keyCombo||r.keyCombo&&r.keyCombo.isEqual(e),s=!t&&!n||!t&&!r.pressHandler||t===r.pressHandler,r=!t&&!n||!n&&!r.releaseHandler||n===r.releaseHandler;i&&s&&r&&(this._listeners.splice(o,1),--o)}},Keyboard.prototype.removeListener=Keyboard.prototype.unbind,Keyboard.prototype.off=Keyboard.prototype.unbind,Keyboard.prototype.setContext=function(e){this._locale&&this.releaseAllKeys(),this._contexts[e]||(this._contexts[e]=[]),this._listeners=this._contexts[e],this._currentContext=e},Keyboard.prototype.getContext=function(){return this._currentContext},Keyboard.prototype.withContext=function(e,t){var n=this.getContext();this.setContext(e),t(),this.setContext(n)},Keyboard.prototype.watch=function(e,t,n,o){var r=this;if(this.stop(),!e){if(!commonjsGlobal.addEventListener&&!commonjsGlobal.attachEvent)throw new Error("Cannot find global functions addEventListener or attachEvent.");e=commonjsGlobal}if("number"==typeof e.nodeType&&(o=n,n=t,t=e,e=commonjsGlobal),!e.addEventListener&&!e.attachEvent)throw new Error("Cannot find addEventListener or attachEvent methods on targetWindow.");this._isModernBrowser=!!e.addEventListener;var i=e.navigator&&e.navigator.userAgent||"",s=e.navigator&&e.navigator.platform||"";t&&null!==t||(t=e.document),n&&null!==n||(n=s),o&&null!==o||(o=i),this._targetKeyDownBinding=function(e){r.pressKey(e.keyCode,e),r._handleCommandBug(e,s)},this._targetKeyUpBinding=function(e){r.releaseKey(e.keyCode,e)},this._targetResetBinding=function(e){r.releaseAllKeys(e)},this._bindEvent(t,"keydown",this._targetKeyDownBinding),this._bindEvent(t,"keyup",this._targetKeyUpBinding),this._bindEvent(e,"focus",this._targetResetBinding),this._bindEvent(e,"blur",this._targetResetBinding),this._targetElement=t,this._targetWindow=e,this._targetPlatform=n,this._targetUserAgent=o},Keyboard.prototype.stop=function(){this._targetElement&&this._targetWindow&&(this._unbindEvent(this._targetElement,"keydown",this._targetKeyDownBinding),this._unbindEvent(this._targetElement,"keyup",this._targetKeyUpBinding),this._unbindEvent(this._targetWindow,"focus",this._targetResetBinding),this._unbindEvent(this._targetWindow,"blur",this._targetResetBinding),this._targetWindow=null,this._targetElement=null)},Keyboard.prototype.pressKey=function(e,t){if(!this._paused){if(!this._locale)throw new Error("Locale not set");this._locale.pressKey(e),this._applyBindings(t)}},Keyboard.prototype.releaseKey=function(e,t){if(!this._paused){if(!this._locale)throw new Error("Locale not set");this._locale.releaseKey(e),this._clearBindings(t)}},Keyboard.prototype.releaseAllKeys=function(e){if(!this._paused){if(!this._locale)throw new Error("Locale not set");this._locale.pressedKeys.length=0,this._clearBindings(e)}},Keyboard.prototype.pause=function(){this._paused||(this._locale&&this.releaseAllKeys(),this._paused=!0)},Keyboard.prototype.resume=function(){this._paused=!1},Keyboard.prototype.reset=function(){this.releaseAllKeys(),this._listeners.length=0},Keyboard.prototype._bindEvent=function(e,t,n){return this._isModernBrowser?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)},Keyboard.prototype._unbindEvent=function(e,t,n){return this._isModernBrowser?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)},Keyboard.prototype._getGroupedListeners=function(){var o=[],r=[],e=this._listeners;return(e="global"!==this._currentContext?[].concat(e,this._contexts.global):e).sort(function(e,t){return(t.keyCombo?t.keyCombo.keyNames.length:0)-(e.keyCombo?e.keyCombo.keyNames.length:0)}).forEach(function(e){for(var t=-1,n=0;n<r.length;n+=1)(null===r[n]&&null===e.keyCombo||null!==r[n]&&r[n].isEqual(e.keyCombo))&&(t=n);-1===t&&(t=r.length,r.push(e.keyCombo)),o[t]||(o[t]=[]),o[t].push(e)}),o},Keyboard.prototype._applyBindings=function(e){var t=!1;(e=e||{}).preventRepeat=function(){t=!0},e.pressedKeys=this._locale.pressedKeys.slice(0);for(var n=this._locale.pressedKeys.slice(0),o=this._getGroupedListeners(),r=0;r<o.length;r+=1){var i=o[r],s=i[0].keyCombo;if(null===s||s.check(n)){for(var a=0;a<i.length;a+=1){var l=i[a];(l=null===s?{keyCombo:new keyCombo(n.join("+")),pressHandler:l.pressHandler,releaseHandler:l.releaseHandler,preventRepeat:l.preventRepeat,preventRepeatByDefault:l.preventRepeatByDefault}:l).pressHandler&&!l.preventRepeat&&(l.pressHandler.call(this,e),t&&(l.preventRepeat=t,t=!1)),l.releaseHandler&&-1===this._appliedListeners.indexOf(l)&&this._appliedListeners.push(l)}if(s)for(a=0;a<s.keyNames.length;a+=1){var d=n.indexOf(s.keyNames[a]);-1!==d&&(n.splice(d,1),--a)}}}},Keyboard.prototype._clearBindings=function(e){e=e||{};for(var t=0;t<this._appliedListeners.length;t+=1){var n=this._appliedListeners[t],o=n.keyCombo;null!==o&&o.check(this._locale.pressedKeys)||(this._callerHandler!==n.releaseHandler&&(o=this._callerHandler,this._callerHandler=n.releaseHandler,n.preventRepeat=n.preventRepeatByDefault,n.releaseHandler.call(this,e),this._callerHandler=o),this._appliedListeners.splice(t,1),--t)}},Keyboard.prototype._handleCommandBug=function(e,t){t.match("Mac")&&this._locale.pressedKeys.includes("command")&&!["shift","ctrl","alt","capslock","tab","command"].includes(this._locale.getKeyNames(e.keyCode)[0])&&this._targetKeyUpBinding(e)};var keyboard=Keyboard,us=function(e,t,n){e.bindKeyCode(3,["cancel"]),e.bindKeyCode(8,["backspace"]),e.bindKeyCode(9,["tab"]),e.bindKeyCode(12,["clear"]),e.bindKeyCode(13,["enter"]),e.bindKeyCode(16,["shift"]),e.bindKeyCode(17,["ctrl"]),e.bindKeyCode(18,["alt","menu"]),e.bindKeyCode(19,["pause","break"]),e.bindKeyCode(20,["capslock"]),e.bindKeyCode(27,["escape","esc"]),e.bindKeyCode(32,["space","spacebar"]),e.bindKeyCode(33,["pageup"]),e.bindKeyCode(34,["pagedown"]),e.bindKeyCode(35,["end"]),e.bindKeyCode(36,["home"]),e.bindKeyCode(37,["left"]),e.bindKeyCode(38,["up"]),e.bindKeyCode(39,["right"]),e.bindKeyCode(40,["down"]),e.bindKeyCode(41,["select"]),e.bindKeyCode(42,["printscreen"]),e.bindKeyCode(43,["execute"]),e.bindKeyCode(44,["snapshot"]),e.bindKeyCode(45,["insert","ins"]),e.bindKeyCode(46,["delete","del"]),e.bindKeyCode(47,["help"]),e.bindKeyCode(145,["scrolllock","scroll"]),e.bindKeyCode(188,["comma",","]),e.bindKeyCode(190,["period","."]),e.bindKeyCode(191,["slash","forwardslash","/"]),e.bindKeyCode(192,["graveaccent","`"]),e.bindKeyCode(219,["openbracket","["]),e.bindKeyCode(220,["backslash","\\"]),e.bindKeyCode(221,["closebracket","]"]),e.bindKeyCode(222,["apostrophe","'"]),e.bindKeyCode(48,["zero","0"]),e.bindKeyCode(49,["one","1"]),e.bindKeyCode(50,["two","2"]),e.bindKeyCode(51,["three","3"]),e.bindKeyCode(52,["four","4"]),e.bindKeyCode(53,["five","5"]),e.bindKeyCode(54,["six","6"]),e.bindKeyCode(55,["seven","7"]),e.bindKeyCode(56,["eight","8"]),e.bindKeyCode(57,["nine","9"]),e.bindKeyCode(96,["numzero","num0"]),e.bindKeyCode(97,["numone","num1"]),e.bindKeyCode(98,["numtwo","num2"]),e.bindKeyCode(99,["numthree","num3"]),e.bindKeyCode(100,["numfour","num4"]),e.bindKeyCode(101,["numfive","num5"]),e.bindKeyCode(102,["numsix","num6"]),e.bindKeyCode(103,["numseven","num7"]),e.bindKeyCode(104,["numeight","num8"]),e.bindKeyCode(105,["numnine","num9"]),e.bindKeyCode(106,["nummultiply","num*"]),e.bindKeyCode(107,["numadd","num+"]),e.bindKeyCode(108,["numenter"]),e.bindKeyCode(109,["numsubtract","num-"]),e.bindKeyCode(110,["numdecimal","num."]),e.bindKeyCode(111,["numdivide","num/"]),e.bindKeyCode(144,["numlock","num"]),e.bindKeyCode(112,["f1"]),e.bindKeyCode(113,["f2"]),e.bindKeyCode(114,["f3"]),e.bindKeyCode(115,["f4"]),e.bindKeyCode(116,["f5"]),e.bindKeyCode(117,["f6"]),e.bindKeyCode(118,["f7"]),e.bindKeyCode(119,["f8"]),e.bindKeyCode(120,["f9"]),e.bindKeyCode(121,["f10"]),e.bindKeyCode(122,["f11"]),e.bindKeyCode(123,["f12"]),e.bindMacro("shift + `",["tilde","~"]),e.bindMacro("shift + 1",["exclamation","exclamationpoint","!"]),e.bindMacro("shift + 2",["at","@"]),e.bindMacro("shift + 3",["number","#"]),e.bindMacro("shift + 4",["dollar","dollars","dollarsign","$"]),e.bindMacro("shift + 5",["percent","%"]),e.bindMacro("shift + 6",["caret","^"]),e.bindMacro("shift + 7",["ampersand","and","&"]),e.bindMacro("shift + 8",["asterisk","*"]),e.bindMacro("shift + 9",["openparen","("]),e.bindMacro("shift + 0",["closeparen",")"]),e.bindMacro("shift + -",["underscore","_"]),e.bindMacro("shift + =",["plus","+"]),e.bindMacro("shift + [",["opencurlybrace","opencurlybracket","{"]),e.bindMacro("shift + ]",["closecurlybrace","closecurlybracket","}"]),e.bindMacro("shift + \\",["verticalbar","|"]),e.bindMacro("shift + ;",["colon",":"]),e.bindMacro("shift + '",["quotationmark","'"]),e.bindMacro("shift + !,",["openanglebracket","<"]),e.bindMacro("shift + .",["closeanglebracket",">"]),e.bindMacro("shift + /",["questionmark","?"]),t.match("Mac")?e.bindMacro("command",["mod","modifier"]):e.bindMacro("ctrl",["mod","modifier"]);for(var o=65;o<=90;o+=1){var r=String.fromCharCode(o+32),i=String.fromCharCode(o);e.bindKeyCode(o,r),e.bindMacro("shift + "+r,i),e.bindMacro("capslock + "+r,i)}var s,a,l=n.match("Firefox")?59:186,d=n.match("Firefox")?173:189,c=n.match("Firefox")?61:187;t.match("Mac")&&(n.match("Safari")||n.match("Chrome"))?(s=91,a=93):t.match("Mac")&&n.match("Opera")?a=s=17:t.match("Mac")&&n.match("Firefox")&&(a=s=224),e.bindKeyCode(l,["semicolon",";"]),e.bindKeyCode(d,["dash","-"]),e.bindKeyCode(c,["equal","equalsign","="]),e.bindKeyCode(s,["command","windows","win","super","leftcommand","leftwindows","leftwin","leftsuper"]),e.bindKeyCode(a,["command","windows","win","super","rightcommand","rightwindows","rightwin","rightsuper"]),e.setKillKey("command")},buildMap=function(){return Object.assign({},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},2<arguments.length&&void 0!==arguments[2]?arguments[2]:{})},updateMap=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},t=buildMap(n,e,t);return isEqual(t,o)?null:t},getSequencesFromMap=function e(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=n?n[t]:null;return n?isArray(n)?n:"object"===_typeof(n)?e("sequence",n):[n]:null===n?[]:[t]},buildBindArray=function(e,o,r,t){Object.keys(r).forEach(function(n){getSequencesFromMap(n,t).forEach(function(t){r[n]&&-1===e.findIndex(function(e){return e.keyCombo===t})&&e.push({keyCombo:t,fn:function(e){o(e,r[n],t)}})})})},HotKeys=function(){_inherits(n,React.Component);var t=_createSuper(n);function n(e){var a;_classCallCheck(this,n),_defineProperty(_assertThisInitialized(a=t.call(this,e)),"handlerWrapper",function(e,t,n){var o=a.props.focused,r=a.isFocused;isBool(o)?contains(a.attachment,e.target)&&(r=o):"function"==typeof o&&(r=o()),r&&n!==a.lastChildSequence&&(a.props.HKcontext.hotKeyParent&&a.props.HKcontext.hotKeyParent.childHandledSequence(n),t(e))}),_defineProperty(_assertThisInitialized(a),"updateHotKeys",function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=a.props,r=o.handlers,i=void 0===r?{}:r,s=o.keyMap,r=o.HKcontext,o=a.state.HKcontext.hotKeyMap,t=t.handlers||{};!e&&!updateMap((void 0===r?{}:r).hotKeyMap,o,s,null==n?void 0:n.HKcontext.hotKeyMap)&&isEqual(i,t)||(a.keyboardjs.stop(),a.keyboardjs.reset(),a.localKeybindings=[],buildBindArray(a.localKeybindings,a.handlerWrapper,i,s),buildBindArray(a.localKeybindings,a.handlerWrapper,i,o),0!==a.localKeybindings.length&&(a.localKeybindings.forEach(function(e){a.keyboardjs.on(e.keyCombo,e.fn)}),a.keyboardjs.watch(a.attachment)))}),_defineProperty(_assertThisInitialized(a),"childHandledSequence",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=a.props.HKcontext.hotKeyParent;a.lastChildSequence=e,t&&t.childHandledSequence(e)}),_defineProperty(_assertThisInitialized(a),"onFocus",function(){var e;a.isFocused=!0,a.props.onFocus&&(e=a.props).onFocus.apply(e,arguments)}),_defineProperty(_assertThisInitialized(a),"onBlur",function(){var e=a.props,t=e.HKcontext.hotKeyParent,e=e.onBlur;a.isFocused=!1,e&&e.apply(void 0,arguments),a.keyboardjs.releaseAllKeys(),t&&t.childHandledSequence(null)});e=_assertThisInitialized(a).childHandledSequence;return a.state={timestamp:void 0,HKcontext:{hotKeyParent:{childHandledSequence:e},hotKeyMap:{}}},a.keyboardjs=null,a.isFocused=!1,a.lastChildSequence=null,a.localKeybindings=[],a}return _createClass(n,[{key:"componentDidMount",value:function(){var e=this.props.attach;this.attachment=e?null!=e&&e.current?e.current:e:ReactDOM.findDOMNode(this),this.keyboardjs=new keyboard(this.attachment),this.keyboardjs.setLocale("us",us),this.updateHotKeys(!0),contains(this.attachment,document.activeElement)&&(this.isFocused=!0),void 0===e&&this.forceUpdate()}},{key:"componentDidUpdate",value:function(e,t){this.updateHotKeys(!1,e,t),isEqual(e.keyMap,this.props.keyMap)||this.setState({timeStamp:(new Date).getTime()})}},{key:"componentWillUnmount",value:function(){var e=this.props.HKcontext.hotKeyParent;e&&e.childHandledSequence(null),this.keyboardjs&&(this.keyboardjs.stop(),this.localKeybindings=[])}},{key:"render",value:function(){var e=this.props.children,t=omit(this.props,"keyMap","handlers","focused","attach","HKcontext");return React.createElement(HotKeysProvider,{value:this.state.HKcontext},React.createElement(FocusTrap,_extends({},t,{onFocus:this.onFocus,onBlur:this.onBlur,element:this.attachment}),e))}}],[{key:"getDerivedStateFromProps",value:function(e,t){e=updateMap(e.HKcontext.hotKeyMap,e.keyMap,{},t.HKcontext.hotKeyMap);return e?{HKcontext:Object.assign({},t.HKcontext,{hotKeyMap:e})}:null}}]),n}();_defineProperty(HotKeys,"propTypes",{HKcontext:PropTypes.object,keyMap:PropTypes.object,handlers:PropTypes.object});var HotKeys$1=withHotKeys(HotKeys);exports.FocusTrap=FocusTrap,exports.HotKeys=HotKeys$1;
